{% comment %}
언어 선택 UI 컴포넌트
사용법: {% include language-selector.html %}
{% endcomment %}

{% assign current_lang = page.lang | default: "ko" %}
{% assign url_parts = page.url | split: "/" %}

{% comment %} 현재 URL에서 언어 코드 부분 찾기 {% endcomment %}
{% assign lang_index = -1 %}
{% for part in url_parts %}
  {% if part == "ko" or part == "en" or part == "ja" %}
    {% assign lang_index = forloop.index0 %}
    {% break %}
  {% endif %}
{% endfor %}

<div class="language-selector">
  <select id="lang-select" onchange="changeLanguage(this.value)">
    <option value="ko" {% if current_lang == "ko" %}selected{% endif %}>한국어</option>
    <option value="en" {% if current_lang == "en" %}selected{% endif %}>English</option>
  </select>
</div>

<script>
function changeLanguage(lang) {
  var currentPath = window.location.pathname;
  var newPath;

  // URL에서 언어 코드 치환
  if (currentPath.includes('/zdm/ko/')) {
    newPath = currentPath.replace('/zdm/ko/', '/zdm/' + lang + '/');
  } else if (currentPath.includes('/zdm/en/')) {
    newPath = currentPath.replace('/zdm/en/', '/zdm/' + lang + '/');
  } else if (currentPath.includes('/zdm/ja/')) {
    newPath = currentPath.replace('/zdm/ja/', '/zdm/' + lang + '/');
  } else {
    // 레거시 URL - ko로 리다이렉트
    newPath = currentPath.replace('/zdm/', '/zdm/' + lang + '/');
  }

  window.location.href = newPath;
}
</script>

<style>
.header-container {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: space-between;
  position: relative;
}

.language-selector {
  position: absolute;
  right: 0;
  bottom: 8px;
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 13px;
}

.language-selector select {
  padding: 4px 8px;
  border: 1px solid #ddd;
  border-radius: 4px;
  background: white;
  cursor: pointer;
  font-size: 13px;
}

.language-selector select:hover {
  border-color: #999;
}
</style>
